<view class="wrap"><block wx:if="{{isRefreshing}}"><view class="refresh-tip"><text>正在刷新数据...</text></view></block><view class="dev-area"><view class="dev-card"><view><view class="dev-name">控制模式</view><image class="dev-log" src="../../static/模式.png"></image></view><view class="curtain-control"><view class="mode-selector"><view data-event-opts="{{[['tap',[['switchMode',[0]]]]]}}" class="{{['mode-option',(mode===0)?'mode-active':'',(isSwitchingMode&&targetMode===0)?'mode-switching':'']}}" bindtap="__e"><text>自动</text><block wx:if="{{isSwitchingMode&&targetMode===0}}"><view class="loading-dot"></view></block></view><view data-event-opts="{{[['tap',[['switchMode',[1]]]]]}}" class="{{['mode-option',(mode===1)?'mode-active':'',(isSwitchingMode&&targetMode===1)?'mode-switching':'']}}" bindtap="__e"><text>手动</text><block wx:if="{{isSwitchingMode&&targetMode===1}}"><view class="loading-dot"></view></block></view><view data-event-opts="{{[['tap',[['switchMode',[2]]]]]}}" class="{{['mode-option',(mode===2)?'mode-active':'',(isSwitchingMode&&targetMode===2)?'mode-switching':'']}}" bindtap="__e"><text>定时</text><block wx:if="{{isSwitchingMode&&targetMode===2}}"><view class="loading-dot"></view></block></view></view></view></view><block wx:if="{{mode===1}}"><view class="dev-card"><view><view class="dev-name">手动控制</view><image class="dev-log" src="../../static/手动控制.png"></image></view><view class="manual-control"><button data-event-opts="{{[['tap',[['onCurtainReverse',['$event']]]]]}}" class="control-btn" bindtap="__e">-30°</button><button data-event-opts="{{[['tap',[['onCurtainForward',['$event']]]]]}}" class="control-btn" bindtap="__e">+30°</button></view></view></block><block wx:if="{{mode===2}}"><view class="dev-card timer-card"><view><view class="dev-name">定时控制</view><image class="dev-log" src="../../static/定时任务.png"></image></view><view class="timer-control"><view class="time-row"><text class="time-label">开始:</text><picker mode="time" value="{{start_time}}" data-event-opts="{{[['change',[['onStartTimeChange',['$event']]]],['tap',[['e0',['$event']]]]]}}" bindchange="__e" bindtap="__e"><view class="time-picker">{{start_time}}</view></picker></view><view class="time-row"><text class="time-label">结束:</text><picker mode="time" value="{{end_time}}" data-event-opts="{{[['change',[['onEndTimeChange',['$event']]]],['tap',[['e1',['$event']]]]]}}" bindchange="__e" bindtap="__e"><view class="time-picker">{{end_time}}</view></picker></view><view class="angle-row-wrapper"><text class="angle-label">角度:</text><view class="slider-container"><slider class="enhanced-slider" value="{{timer_angle}}" min="0" max="180" step="10" show-value="{{true}}" data-event-opts="{{[['change',[['onTimerAngleChange',['$event']]]]]}}" bindchange="__e"></slider></view></view></view></view></block><view class="dev-card"><view><view class="dev-name">光照强度</view><image class="dev-log" src="../../static/光照强度.png"></image></view><view class="{{['dev-data',(dataUpdated)?'data-updated':'']}}">{{light+"lux"}}</view></view><view class="dev-card"><view><view class="dev-name">当前角度</view><image class="dev-log" src="../../static/旋转角度.png"></image></view><view class="dev-data">{{angle+"°"}}</view></view></view><block wx:if="{{errorMsg}}"><view class="error-message"><text>{{errorMsg}}</text><button data-event-opts="{{[['tap',[['retryConnection',['$event']]]]]}}" class="retry-btn" bindtap="__e">重试</button></view></block></view>